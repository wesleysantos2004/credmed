<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprovar Solicitação - Portal Administrativo</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/custom.css">
</head>

<body>

    <!-- Mobile Header -->
    <div class="mobile-header">
        <button class="menu-toggle" onclick="toggleMobileMenu()">
            <i class="bi bi-list"></i>
        </button>
        <h5 class="text-danger fw-bold flex-grow-1 text-center">
            <i class="bi bi-shield-lock me-2"></i>Portal Admin
        </h5>
        <div style="width: 40px;"></div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay"></div>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="px-3 mb-4">
            <h5 class="text-danger fw-bold mb-0">
                <i class="bi bi-shield-lock me-2"></i>Portal Admin
            </h5>
        </div>
        <nav class="nav flex-column">
            <a class="nav-link" href="dashboard.html">
                <i class="bi bi-house-door"></i>
                Dashboard
            </a>
            <a class="nav-link active" href="aprovacoes.html">
                <i class="bi bi-clipboard-check"></i>
                Aprovações
            </a>
            <a class="nav-link" href="pagamentos.html">
                <i class="bi bi-cash-coin"></i>
                Pagamentos
            </a>
            <a class="nav-link" href="relatorios.html">
                <i class="bi bi-graph-up"></i>
                Relatórios
            </a>
            <hr class="my-3">
            <a class="nav-link text-danger" href="#" onclick="logout()">
                <i class="bi bi-box-arrow-right"></i>
                Sair
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="mb-4">
            <a href="aprovacoes.html" class="btn btn-outline-secondary btn-sm mb-3">
                <i class="bi bi-arrow-left me-2"></i>
                Voltar para Lista
            </a>
            <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">
                <div>
                    <h2 class="mb-1">Revisar e Aprovar Solicitação</h2>
                    <p class="text-muted mb-0">Protocolo: <strong id="protocolo">SOL-2025-00043</strong></p>
                </div>
                <span class="badge bg-warning text-dark fs-6 py-2 px-3">
                    <i class="bi bi-clock-history me-2"></i>
                    Aguardando Aprovação
                </span>
            </div>
        </div>

        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <!-- Informações do Médico -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4">
                            <i class="bi bi-person-badge me-2"></i>
                            Informações do Médico
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <small class="text-muted d-block">Nome</small>
                                <strong>Dr. Fernando Silva</strong>
                            </div>
                            <div class="col-md-3 mb-3">
                                <small class="text-muted d-block">CRM</small>
                                <strong>12345/SP</strong>
                            </div>
                            <div class="col-md-3 mb-3">
                                <small class="text-muted d-block">CPF</small>
                                <strong>***. 456.789-**</strong>
                            </div>
                            <div class="col-md-6 mb-3">
                                <small class="text-muted d-block">E-mail</small>
                                <strong>fernando.silva@email.com</strong>
                            </div>
                            <div class="col-md-6 mb-3">
                                <small class="text-muted d-block">Telefone</small>
                                <strong>(11) 98765-4321</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Informações da Solicitação -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4">
                            <i class="bi bi-file-text me-2"></i>
                            Informações da Solicitação
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <small class="text-muted d-block">Empresa</small>
                                <strong>MedPlus</strong>
                            </div>
                            <div class="col-md-6 mb-3">
                                <small class="text-muted d-block">Status da Validação</small>
                                <span class="badge bg-success">Validado pela Empresa</span>
                            </div>
                            <div class="col-md-4 mb-3">
                                <small class="text-muted d-block">Data Solicitação</small>
                                <strong>26/12/2025 14:30</strong>
                            </div>
                            <div class="col-md-4 mb-3">
                                <small class="text-muted d-block">Data Validação</small>
                                <strong>26/12/2025 16:45</strong>
                            </div>
                            <div class="col-md-4 mb-3">
                                <small class="text-muted d-block">Tempo Decorrido</small>
                                <strong class="text-warning">2h 15min</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Valores -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4">
                            <i class="bi bi-calculator me-2"></i>
                            Resumo Financeiro
                        </h5>
                        <div class="table-responsive">
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <td><strong>Valor Total dos Plantões</strong></td>
                                        <td class="text-end"><strong>R$ 3.500,00</strong></td>
                                    </tr>
                                    <tr>
                                        <td>Taxa da Plataforma (3.5%)</td>
                                        <td class="text-end text-danger">- R$ 122,50</td>
                                    </tr>
                                    <tr class="table-active">
                                        <td><strong>Valor Líquido ao Médico</strong></td>
                                        <td class="text-end">
                                            <strong class="text-success fs-5">R$ 3.377,50</strong>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Cashback para Empresa (1%)</td>
                                        <td class="text-end text-success">R$ 35,00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Plantões -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4">
                            <i class="bi bi-calendar-check me-2"></i>
                            Plantões (Validados pela Empresa)
                        </h5>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Data</th>
                                        <th>Descrição</th>
                                        <th class="text-end">Valor</th>
                                        <th>Status Empresa</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>28/12/2025</strong></td>
                                        <td>Plantão 12h - Emergência</td>
                                        <td class="text-end"><strong>R$ 1.800,00</strong></td>
                                        <td><span class="badge bg-success">Validado</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>30/12/2025</strong></td>
                                        <td>Plantão 24h - UTI</td>
                                        <td class="text-end"><strong>R$ 1.700,00</strong></td>
                                        <td><span class="badge bg-success">Validado</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Dados Bancários -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4">
                            <i class="bi bi-bank me-2"></i>
                            Dados Bancários do Médico
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <small class="text-muted d-block">Banco</small>
                                <strong>001 - Banco do Brasil</strong>
                            </div>
                            <div class="col-md-3 mb-3">
                                <small class="text-muted d-block">Agência</small>
                                <strong>1234-5</strong>
                            </div>
                            <div class="col-md-3 mb-3">
                                <small class="text-muted d-block">Conta</small>
                                <strong>12345678-9</strong>
                            </div>
                            <div class="col-md-12 mb-3">
                                <small class="text-muted d-block">Chave PIX</small>
                                <strong>fernando.silva@email.com</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Documentos -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-3">
                            <i class="bi bi-paperclip me-2"></i>
                            Documentos Anexados
                        </h5>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center">
                                <i class="bi bi-file-earmark-pdf text-danger fs-3 me-3"></i>
                                <div class="flex-grow-1">
                                    <div class="fw-bold">Contrato Assinado</div>
                                    <small class="text-muted">PDF • 245 KB • Upload: 26/12/2025</small>
                                </div>
                                <button class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-download"></i>
                                </button>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center">
                                <i class="bi bi-file-earmark-text text-primary fs-3 me-3"></i>
                                <div class="flex-grow-1">
                                    <div class="fw-bold">Comprovantes de Plantão</div>
                                    <small class="text-muted">PDF • 1.2 MB • Upload: 26/12/2025</small>
                                </div>
                                <button class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-download"></i>
                                </button>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center">
                                <i class="bi bi-file-earmark-pdf text-danger fs-3 me-3"></i>
                                <div class="flex-grow-1">
                                    <div class="fw-bold">Validação da Empresa</div>
                                    <small class="text-muted">PDF • 180 KB • Upload: 26/12/2025</small>
                                </div>
                                <button class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-download"></i>
                                </button>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Decisão de Aprovação -->
                <div class="card card-custom border-warning">
                    <div class="card-body">
                        <h5 class="card-title mb-4 text-warning">
                            <i class="bi bi-clipboard-check me-2"></i>
                            Decisão de Aprovação
                        </h5>
                        <form id="formAprovacao">
                            <div class="mb-4">
                                <label class="form-label">Observações Internas (Opcional)</label>
                                <textarea class="form-control" id="observacoes" rows="3"
                                    placeholder="Adicione observações sobre esta aprovação..."></textarea>
                            </div>

                            <div class="alert alert-info">
                                <i class="bi bi-info-circle me-2"></i>
                                <strong>Atenção:</strong> Ao aprovar, o pagamento será processado automaticamente via
                                PIX.
                            </div>

                            <div class="d-flex gap-2 flex-wrap">
                                <button type="button" class="btn btn-success btn-lg" onclick="aprovar()">
                                    <i class="bi bi-check-circle me-2"></i>
                                    Aprovar e Processar Pagamento
                                </button>
                                <button type="button" class="btn btn-danger btn-lg" onclick="mostrarModalRejeicao()">
                                    <i class="bi bi-x-circle me-2"></i>
                                    Rejeitar Solicitação
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-lg"
                                    onclick="window.location.href='aprovacoes.html'">
                                    Cancelar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Right Sidebar -->
            <div class="col-lg-4">
                <!-- Timeline -->
                <div class="card card-custom mb-4">
                    <div class="card-body">
                        <h6 class="card-title mb-3">
                            <i class="bi bi-clock-history me-2"></i>
                            Histórico da Solicitação
                        </h6>
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-marker" style="background-color: var(--success);"></div>
                                <div class="timeline-content">
                                    <strong>Validado pela Empresa</strong>
                                    <div class="small text-muted mt-1">26/12/2025 16:45</div>
                                    <p class="small mb-0 mt-1">MedPlus validou todos os plantões</p>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-marker" style="background-color: var(--primary);"></div>
                                <div class="timeline-content">
                                    <strong>Solicitação Criada</strong>
                                    <div class="small text-muted mt-1">26/12/2025 14:30</div>
                                    <p class="small mb-0 mt-1">Dr. Fernando Silva criou a solicitação</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Checklist -->
                <div class="card card-custom">
                    <div class="card-body">
                        <h6 class="card-title mb-3">
                            <i class="bi bi-list-check me-2"></i>
                            Checklist de Aprovação
                        </h6>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="check1" checked disabled>
                            <label class="form-check-label" for="check1">
                                Empresa validou os plantões
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="check2" checked disabled>
                            <label class="form-check-label" for="check2">
                                Documentos completos
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="check3" checked disabled>
                            <label class="form-check-label" for="check3">
                                Dados bancários válidos
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="check4" checked disabled>
                            <label class="form-check-label" for="check4">
                                Contrato assinado
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="check5" checked disabled>
                            <label class="form-check-label" for="check5">
                                Valor dentro do limite
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Rejeição -->
    <div class="modal fade" id="modalRejeicao" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-x-circle me-2"></i>
                        Rejeitar Solicitação
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        Esta ação não pode ser desfeita. O médico será notificado.
                    </div>
                    <div class="mb-3">
                        <label for="motivoRejeicao" class="form-label">Motivo da Rejeição <span
                                class="text-danger">*</span></label>
                        <select class="form-select mb-2" id="motivoRejeicao" required>
                            <option value="">Selecione o motivo...</option>
                            <option value="documentacao_incompleta">Documentação Incompleta</option>
                            <option value="dados_incorretos">Dados Incorretos</option>
                            <option value="plantoes_invalidos">Plantões Inválidos</option>
                            <option value="fraude_suspeita">Suspeita de Fraude</option>
                            <option value="outro">Outro</option>
                        </select>
                        <textarea class="form-control" id="detalhesRejeicao" rows="3"
                            placeholder="Detalhe o motivo da rejeição..." required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="rejeitar()">
                        Confirmar Rejeição
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="../assets/js/app.js"></script>

    <script>
        checkAuth('admin');

        let modalRejeicao;

        document.addEventListener('DOMContentLoaded', function () {
            modalRejeicao = new bootstrap.Modal(document.getElementById('modalRejeicao'));
        });

        function aprovar() {
            if (confirm('Confirma a aprovação desta solicitação? O pagamento será processado imediatamente.')) {
                alert('Solicitação aprovada com sucesso! Pagamento em processamento.');
                window.location.href = 'pagamentos.html';
            }
        }

        function mostrarModalRejeicao() {
            modalRejeicao.show();
        }

        function rejeitar() {
            const motivo = document.getElementById('motivoRejeicao').value;
            const detalhes = document.getElementById('detalhesRejeicao').value;

            if (!motivo || !detalhes) {
                alert('Preencha o motivo e os detalhes da rejeição');
                return;
            }

            alert('Solicitação rejeitada. O médico será notificado.');
            modalRejeicao.hide();
            window.location.href = 'aprovacoes.html';
        }
    </script>
</body>

</html>